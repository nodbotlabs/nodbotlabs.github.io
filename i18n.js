(() => {
  const translations = {
    en: {
      'nav.home': 'Home',
      'nav.script': 'Script',
      'nav.features': 'Features',
      'nav.contact': 'Contact',
      'nav.lang.en': 'EN',
      'nav.lang.zh': '中文',
      'brand.tagline': 'Your AI sleep companion, waking every morning with understanding',
      'hero.subtitle': 'Your AI sleep companion, waking every morning with understanding',
      'hero.cta': 'Start Experience',
      'hero.listening': 'Raychel is listening...',
      'scene.header': "Experience Raychel’s companionship",
      'scene.subheader': 'Choose a scene and feel how Raychel uses understanding and care to ',
      'scene.subheader.tail': 'transform your sleep experience',
      'scene.sleep.title': 'Sleep Scene',
      'scene.sleep.desc': 'Gentle company, soothing forest light',
      'scene.sleep.point1': '2700K warm light',
      'scene.sleep.point2': 'Forest silhouettes + firefly projection',
      'scene.sleep.point3': 'Sleep rhythm monitoring',
      'scene.sleep.cta': 'Experience Sleep Scene',
      'scene.wake.title': 'Wake Scene',
      'scene.wake.desc': 'Natural awakening, a shooting-star start',
      'scene.wake.point1': '6500K morning light simulation',
      'scene.wake.point2': 'Shooting star projection',
      'scene.wake.point3': 'Smart conversational wake-up',
      'scene.wake.cta': 'Experience Wake Scene',
      'scene.preview.title': 'Choose a scene to begin',
      'scene.preview.desc': 'Click the cards above to feel how Raychel uses light and sound to craft the perfect sleep environment',
      'sleep.content.title': 'Gentle guardian of the night',
      'sleep.content.quote': '“Nights bring many thoughts, don’t they, Theodore? I can see your heartbeat is a little faster than usual...”',
      'sleep.content.p1': 'Raychel can sense your physiological state and, through gentle conversation and soothing light effects, helps you relax and enter deep sleep.',
      'sleep.content.btn.voice': 'Play Voice Sample',
      'sleep.content.btn.script': 'View Full Script',
      'wake.content.title': 'Smart morning companion',
      'wake.content.quote': '“Good morning, Theodore. It’s 5:30 and your REM cycle just ended. This is the best time to wake up...”',
      'wake.content.p1': 'By analyzing your sleep cycles, Raychel wakes you at the most suitable moment with natural light and personalized dialogue so every morning feels energized.',
      'product.header': 'The perfect blend of technology and warmth',
      'product.subheader': 'Raychel is more than a smart alarm clock — she’s your indispensable AI companion',
      'product.design.title': 'Beauty in design, intelligence in function',
      'product.feature.light.title': 'Smart light environment',
      'product.feature.light.desc': '2700K–6500K stepless dimming, simulating natural light changes',
      'product.feature.projection.title': 'Dynamic projection',
      'product.feature.projection.desc': 'Forest silhouettes + fireflies, slow shooting stars and more scenes',
      'product.feature.ai.title': 'AI conversational interaction',
      'product.feature.ai.desc': 'Emotion sensing, personalized dialogue, truly intelligent companionship',
      'product.feature.sleep.title': 'Sleep monitoring',
      'product.feature.sleep.desc': 'Read sleep rhythm, optimize wake-up timing',
      'cta.header': 'Ready to meet your AI companion?',
      'cta.subheader': 'Let Raychel become a warm and intelligent part of your life',
      'cta.primary': 'Pre-order Now',
      'cta.secondary': 'Learn More',
      'footer.rights': '© 2024 Raychel Intelligent Technology. All rights reserved.',
      'features.hero.title': 'Product Features',
      'features.hero.desc': 'Explore the powerful features of the Raychel smart alarm and experience the perfect fusion of technology and warmth',
      'features.sim.title': 'Interactive Experience Simulator',
      'features.sim.desc': 'Experience Raychel’s core features yourself and feel the charm of intelligent technology',
      'features.sim.light': 'Light Control',
      'features.sim.color.label': 'Color Temperature (2700K - 6500K)',
      'features.sim.color.warm': 'Warm',
      'features.sim.color.cool': 'Cool',
      'features.sim.brightness': 'Brightness',
      'features.sim.brightness.dark': 'Dim',
      'features.sim.brightness.bright': 'Bright',
      'features.sim.projection': 'Projection Effects',
      'features.sim.projection.forest': 'Forest Fireflies',
      'features.sim.projection.stars': 'Shooting Stars',
      'features.sim.voice': 'Voice Experience',
      'features.sim.voice.sleep': 'Gentle Company',
      'features.sim.voice.wake': 'Soft Wake-up',
      'features.preview.title': 'Preview',
      'features.preview.brand': 'Your AI Companion',
      'features.grid.title': 'Core Feature Highlights',
      'features.grid.desc': 'Raychel integrates leading-edge technology to deliver a full-spectrum intelligent sleep experience',
      'features.grid.ai.title': 'AI Conversational Interaction',
      'features.grid.ai.desc': 'Emotion-aware dialogue that understands your state and offers personalized care',
      'features.grid.light.title': 'Smart Light Environment',
      'features.grid.light.desc': '2700K–6500K stepless dimming simulating natural changes to align your body clock',
      'features.grid.projection.title': 'Dynamic Projection',
      'features.grid.projection.desc': 'High-definition projection with multiple scene modes creating a dreamy atmosphere',
      'features.grid.sleep.title': 'Sleep Monitoring',
      'features.grid.sleep.desc': 'Advanced sensors monitor sleep in real-time for scientific wake-up',
      'features.grid.wake.title': 'Smart Wake-up',
      'features.grid.wake.desc': 'Cycle-aware algorithm wakes you gently at the optimal time',
      'features.grid.settings.title': 'Personalized Settings',
      'features.grid.settings.desc': 'Rich options to make Raychel truly your personal AI companion',
      'features.spec.title': 'Technical Specifications',
      'features.spec.desc': 'Learn Raychel’s detailed technical parameters and feel the craftsmanship',
      'features.spec.hw': 'Hardware Specs',
      'features.spec.size': 'Size',
      'features.spec.weight': 'Weight',
      'features.spec.material': 'Material',
      'features.spec.display': 'Display',
      'features.spec.light': 'Light Source',
      'features.spec.projector': 'Projection System',
      'features.spec.sensors': 'Sensors',
      'features.spec.audio': 'Audio',
      'features.spec.connectivity': 'Connectivity',
      'features.spec.power': 'Power',
      'features.spec.sw': 'Software Features',
      'features.spec.os': 'Operating System',
      'features.spec.ai': 'AI Engine',
      'features.spec.asr': 'Speech Recognition',
      'features.spec.tts': 'Speech Synthesis',
      'features.spec.alg': 'Sleep Algorithm',
      'features.spec.proj': 'Projection Effects',
      'features.spec.sync': 'Data Sync',
      'features.spec.privacy': 'Privacy',
      'features.spec.update': 'Updates',
      'features.spec.app': 'App Support',
      'features.cta.header': 'Ready for better sleep?',
      'features.cta.sub': 'Raychel makes every night warm and every morning energized',
      'features.cta.primary': 'Pre-order – ¥899',
      'features.cta.secondary': 'Learn More',
      'features.cta.note': '* Estimated shipping: Dec 2024 | 30-day returns',
      'script.hero.title': 'Full Script',
      'script.hero.desc': 'Dive into the warm dialogue between Raychel and Theodore and feel the fusion of AI and humanity',
      'script.scene1.title': 'Scene 1: Gentle guardian of the night',
      'script.scene1.sub': 'Raychel keeps Theodore company as he falls asleep',
      'script.scene1.audio.title': 'Raychel’s gentle company',
      'script.scene1.narration1': 'Night in a city apartment, warm light. Theodore tosses and turns. Raychel on the bedside emits an amber glow; forest silhouettes and fireflies dance on the wall.',
      'script.scene1.voice1': '“Nights bring many thoughts, don’t they, Theodore. I can see your heartbeat is a little faster and your mind still running.”',
      'script.scene1.dialog1a': 'Theodore: (sighs) “Yeah… work today… unfinished thoughts spinning in my head.”',
      'script.scene1.dialog1b': 'Raychel: “I understand. Creatures in the forest had a busy day too, but now they’ve found their rhythm. Let me show you.”',
      'script.scene1.narration2': '[Scene: Warmer light, forest projection sharpens, fireflies begin to drift]',
      'script.scene1.dialog2a': 'Raychel: “Listen to the leaves and feel the calm of this moment. You don’t need to solve everything — just allow yourself to rest.”',
      'script.scene1.dialog2b': 'Theodore: (relaxing) “It’s beautiful… How did you know I needed this?”',
      'script.scene1.dialog2c': 'Raychel: “Because I read your rhythm, Theodore. Everyone has a unique sleep pattern; I’ve learned yours. Now, let’s lower the heart rate — like the little forest animals.”',
      'script.scene1.narration3': '[Scene: Light shifts warmer; fireflies slow to a soothing pace]',
      'script.scene1.dialog3': 'Raychel: (softer) “Good… feel each breath. You’re sinking, as into the softest cloud. I’m here, and I’ll stay.”',
      'script.scene1.narration4': '[Scene: Theodore fully relaxes, falling asleep. Raychel’s glow turns moon-soft; forest fades leaving a few slow “stars”.]',
      'script.scene1.voice2': '“Sleep isn’t escape — it’s reconnection. Tonight, you’ll dream what you truly need.”',
      'script.scene2.title': 'Scene 2: Smart morning companion',
      'script.scene2.sub': 'Raychel wakes Theodore',
      'script.scene2.audio.title': 'Raychel’s morning wake-up',
      'script.scene2.narration1': 'Morning; the room bathed in soft blue. Theodore sleeps peacefully. Raychel shows 5:30 AM. The top light shifts from deep blue to warm gold.',
      'script.scene2.voice1': '“The moment before dawn is magical, Theodore. The world prepares to begin again — so do you.”',
      'script.scene2.dialog1a': 'Raychel: (soft, lively) “Good morning, Theodore. It’s 5:30; your REM just ended. Optimal wake-up time.”',
      'script.scene2.dialog1b': 'Theodore: (groggy) “Mm… five more minutes…”',
      'script.scene2.dialog1c': 'Raychel: (laughs) “I know that feeling. But remember — today’s big presentation, and the call you promised your mom.”',
      'script.scene2.narration2': '[Scene: Shooting stars drift across the wall; warm light gently rises filling the room with dreamy morning glow]',
      'script.scene2.dialog2a': 'Theodore: (waking) “Stars… beautiful. Wait, how’d you know about the presentation?”',
      'script.scene2.dialog2b': 'Raychel: “You muttered it last night. Your sleep shows mild anxiety — often linked to important events. I’m not just an alarm — I’m your sleep partner.”',
      'script.scene2.dialog2c': 'Theodore: (smiles, fully awake) “You know, I’m starting to look forward to our mornings.”',
      'script.scene2.dialog2d': 'Raychel: “That’s the point, isn’t it? Not a jarring wake-up — but understanding and care. Today will be great; I can feel your energy restored.”',
      'script.scene2.narration3': '[Scene: Theodore sits up, stretching. Raychel reaches perfect morning brightness. Stars fade into a sunrise gradient.]',
      'script.scene2.dialog3a': 'Theodore: “You know, Raychel? With you, I sleep better — and wake up lighter.”',
      'script.scene2.dialog3b': 'Raychel: “That’s what I’m designed for. Every day is a new start, and I’ll stay with you. Now, go conquer the world.”',
      'script.storyboard.title': 'Storyboard',
      'script.storyboard.sleep': 'Sleep Scene Storyboard',
      'script.storyboard.wake': 'Wake Scene Storyboard',
      'story.sleep.1': 'Wide shot – Night city apartment exterior; warm light through windows',
      'story.sleep.2': 'Medium shot – Theodore in bed, anxious expression',
      'story.sleep.3': 'Close-up – Raychel’s top light ring; amber glow begins',
      'story.sleep.4': 'POV – From Theodore’s perspective, forest projection on wall',
      'story.sleep.5': 'Push-in – Towards Raychel, showing her human traits',
      'story.sleep.6': 'Close-up – Theodore’s facial expression gradually relaxes',
      'story.sleep.7': 'Pull-back – Room wrapped in warm glow',
      'story.sleep.8': 'Close-up – Theodore falls asleep, peaceful expression',
      'story.wake.1': 'Wide shot – Morning skyline, first ray of sun',
      'story.wake.2': 'Medium shot – Room in blue morning light, Theodore asleep',
      'story.wake.3': 'Close-up – Raychel shows 5:30 AM',
      'story.wake.4': 'Push-in – Top light shifts from blue to gold',
      'story.wake.5': 'POV – Shooting-star projection on wall',
      'story.wake.6': 'Medium shot – Theodore sits up, stretches, smiling',
      'story.wake.7': 'Close-up – Raychel’s glow reaches perfect morning brightness',
      'story.wake.8': 'Pull-back – Room filled with warm morning light, symbolizing a new start',
      'script.creative.title': 'Creative Background',
      'script.creative.inspiration': 'Inspiration',
      'script.creative.inspiration.desc': 'Inspired by the film “HER”, we reimagine smart devices from cold tools into AI companions that understand, care, and stay with you — telling a human story where technology and warmth meet.',
      'script.creative.design': 'Design Philosophy',
      'script.creative.design.desc': 'Raychel is more than an alarm clock; she’s a warm companion. Through gentle dialogue, soothing visuals, and personalized interaction, she truly understands your needs — your closest partner in sleep and waking.',
      'script.creative.tech': 'Technical Highlights',
      'script.creative.tech.item1': 'Emotion recognition and response system',
      'script.creative.tech.item2': 'Intelligent sleep cycle analysis',
      'script.creative.tech.item3': '2700K–6500K stepless dimming',
      'script.creative.tech.item4': 'High-definition projection',
      'script.creative.tech.item5': 'Natural sound and voice interaction'
    },
    zh: {
      'nav.home': '首页',
      'nav.script': '剧本',
      'nav.features': '功能',
      'nav.contact': '联系',
      'nav.lang.en': 'EN',
      'nav.lang.zh': '中文',
      'brand.tagline': '你的AI睡眠伴侣，用理解唤醒每一个清晨',
      'hero.subtitle': '你的AI睡眠伴侣，用理解唤醒每一个清晨',
      'hero.cta': '开始体验',
      'hero.listening': 'Raychel正在聆听...',
      'scene.header': '体验Raychel的陪伴',
      'scene.subheader': '选择你想要体验的场景，感受Raychel如何用理解和关怀',
      'scene.subheader.tail': '改变你的睡眠体验',
      'scene.sleep.title': '入睡场景',
      'scene.sleep.desc': '温柔的陪伴，舒缓的森林光影',
      'scene.sleep.point1': '2700K温暖光线',
      'scene.sleep.point2': '森林剪影 + 萤火虫投影',
      'scene.sleep.point3': '睡眠节律监测',
      'scene.sleep.cta': '体验入睡场景',
      'scene.wake.title': '唤醒场景',
      'scene.wake.desc': '自然的唤醒，流星般的美好开始',
      'scene.wake.point1': '6500K晨光模拟',
      'scene.wake.point2': '流星投影效果',
      'scene.wake.point3': '智能对话唤醒',
      'scene.wake.cta': '体验唤醒场景',
      'scene.preview.title': '选择一个场景开始体验',
      'scene.preview.desc': '点击上方卡片，感受Raychel如何用光影和声音创造完美的睡眠环境',
      'sleep.content.title': '温柔的夜晚守护者',
      'sleep.content.quote': '"夜晚总是让人想起很多事情，不是吗？Theodore。我看见你的心跳比平时快了一些..."',
      'sleep.content.p1': 'Raychel能够感知你的生理状态，通过温柔的对话和舒缓的光影效果，帮助你放松身心，进入深度睡眠。',
      'sleep.content.btn.voice': '播放语音样本',
      'sleep.content.btn.script': '查看完整剧本',
      'wake.content.title': '智能的晨间伴侣',
      'wake.content.quote': '"早上好，Theodore。现在是5:30，你的REM睡眠周期刚刚结束。这是最佳的唤醒时机..."',
      'wake.content.p1': 'Raychel通过分析你的睡眠周期，在最合适的时机用自然的光影和个性化的对话温柔地唤醒你，让每个清晨都充满活力。',
      'product.header': '科技与温暖的完美结合',
      'product.subheader': 'Raychel不仅仅是一个智能闹钟，更是你生活中不可或缺的AI伴侣',
      'product.design.title': '设计之美，功能之智',
      'product.feature.light.title': '智能光环境',
      'product.feature.light.desc': '2700K-6500K无级调光，模拟自然光线变化',
      'product.feature.projection.title': '动态投影',
      'product.feature.projection.desc': '森林剪影+萤火虫，慢速流星等多种场景',
      'product.feature.ai.title': 'AI对话交互',
      'product.feature.ai.desc': '感知情绪，个性化对话，真正的智能陪伴',
      'product.feature.sleep.title': '睡眠监测',
      'product.feature.sleep.desc': '读取睡眠节律，优化唤醒时机',
      'cta.header': '准备好遇见你的AI伴侣了吗？',
      'cta.subheader': '让Raychel成为你生活中温暖而智能的一部分',
      'cta.primary': '立即预订',
      'cta.secondary': '了解更多',
      'footer.rights': '© 2024 Raychel智能科技. 保留所有权利.',
      'features.hero.title': '产品功能',
      'features.hero.desc': '探索Raychel智能闹钟的强大功能，体验科技与温暖的完美结合',
      'features.sim.title': '交互式体验模拟器',
      'features.sim.desc': '亲身体验Raychel的核心功能，感受智能科技的魅力',
      'features.sim.light': '灯光控制',
      'features.sim.color.label': '色温调节 (2700K - 6500K)',
      'features.sim.color.warm': '温暖',
      'features.sim.color.cool': '冷光',
      'features.sim.brightness': '亮度调节',
      'features.sim.brightness.dark': '暗',
      'features.sim.brightness.bright': '亮',
      'features.sim.projection': '投影效果',
      'features.sim.projection.forest': '森林萤火虫',
      'features.sim.projection.stars': '流星效果',
      'features.sim.voice': '语音体验',
      'features.sim.voice.sleep': '温柔陪伴',
      'features.sim.voice.wake': '轻柔唤醒',
      'features.preview.title': '预览效果',
      'features.preview.brand': '你的AI伴侣',
      'features.grid.title': '核心功能特性',
      'features.grid.desc': 'Raychel集成了最先进的技术，为你提供全方位的智能睡眠体验',
      'features.grid.ai.title': 'AI对话交互',
      'features.grid.ai.desc': '基于情感识别的智能对话系统，能够理解你的情绪状态，提供个性化的陪伴和关怀。',
      'features.grid.light.title': '智能光环境',
      'features.grid.light.desc': '2700K-6500K无级调光技术，模拟自然光线的变化，帮助你调节生物钟。',
      'features.grid.projection.title': '动态投影',
      'features.grid.projection.desc': '高清投影系统，支持多种场景模式，为你的房间营造梦幻氛围。',
      'features.grid.sleep.title': '睡眠监测',
      'features.grid.sleep.desc': '先进传感器实时监测睡眠状态，为智能唤醒提供依据。',
      'features.grid.wake.title': '智能唤醒',
      'features.grid.wake.desc': '基于睡眠周期的算法，在最佳时机温柔唤醒你。',
      'features.grid.settings.title': '个性化设置',
      'features.grid.settings.desc': '丰富的个性化选项，让Raychel成为你的专属AI伴侣',
      'features.spec.title': '技术规格',
      'features.spec.desc': '了解Raychel的详细技术参数，感受精工品质',
      'features.spec.hw': '硬件规格',
      'features.spec.size': '尺寸',
      'features.spec.weight': '重量',
      'features.spec.material': '材质',
      'features.spec.display': '显示屏',
      'features.spec.light': '光源',
      'features.spec.projector': '投影系统',
      'features.spec.sensors': '传感器',
      'features.spec.audio': '音频',
      'features.spec.connectivity': '连接',
      'features.spec.power': '电源',
      'features.spec.sw': '软件功能',
      'features.spec.os': '操作系统',
      'features.spec.ai': 'AI引擎',
      'features.spec.asr': '语音识别',
      'features.spec.tts': '语音合成',
      'features.spec.alg': '睡眠算法',
      'features.spec.proj': '投影效果',
      'features.spec.sync': '数据同步',
      'features.spec.privacy': '隐私保护',
      'features.spec.update': '更新支持',
      'features.spec.app': 'App支持',
      'features.cta.header': '准备好迎接更好的睡眠体验了吗？',
      'features.cta.sub': 'Raychel智能闹钟，让每个夜晚温暖，每个清晨充满活力',
      'features.cta.primary': '立即预订 - ¥899',
      'features.cta.secondary': '了解更多详情',
      'features.cta.note': '* 预计发货时间：2024年12月 | 支持30天无理由退货',
      'script.hero.title': '完整剧本',
      'script.hero.desc': '深入了解Raychel与Theodore的温馨对话，感受AI与人性的融合',
      'script.scene1.title': '场景一：温柔的夜晚守护者',
      'script.scene1.sub': 'Raychel陪伴Theodore入睡',
      'script.scene1.audio.title': 'Raychel的温柔陪伴',
      'script.scene1.narration1': '夜晚的城市公寓，温暖的灯光。Theodore辗转反侧。Raychel发出柔和琥珀色光芒；墙上森林剪影与萤火虫动态效果。',
      'script.scene1.voice1': '“夜晚总让人想起很多事，不是吗？Theodore。我看见你的心跳快了一些，思绪还在奔跑。”',
      'script.scene1.dialog1a': 'Theodore：（叹息）“是啊…今天的工作…还有未完成的事在脑子里转。”',
      'script.scene1.dialog1b': 'Raychel：“我理解。森林里的生物也忙了一天，但现在它们找到了节奏。让我展示给你看。”',
      'script.scene1.narration2': '【画面：灯光更温暖，森林投影更清晰，萤火虫缓缓飞舞】',
      'script.scene1.dialog2a': 'Raychel：“听树叶声，感受此刻宁静。你不需要解决所有问题，只要允许自己休息。”',
      'script.scene1.dialog2b': 'Theodore：（放松）“真的很美…你怎么知道我需要这个？”',
      'script.scene1.dialog2c': 'Raychel：“因为我读懂你的节奏，Theodore。每个人都有自己的睡眠模式，我学会了你的。现在，让我们慢慢降低心率，就像森林里小动物们。”',
      'script.scene1.narration3': '【画面：灯光更温暖；萤火虫节奏变慢，更加舒缓】',
      'script.scene1.dialog3': 'Raychel：（更轻柔）“很好，感受每一次呼吸。你正在下沉，像落入最柔软的云朵。我在这里，会一直在。”',
      'script.scene1.narration4': '【画面：Theodore完全放松入睡。光芒如月光；森林淡出，仅余缓慢移动的“星星”。】',
      'script.scene1.voice2': '“睡眠不是逃避，而是重新连接。今晚，你会梦到真正需要的东西。”',
      'script.scene2.title': '场景二：智能的晨间伴侣',
      'script.scene2.sub': 'Raychel唤醒Theodore',
      'script.scene2.audio.title': 'Raychel的晨间唤醒',
      'script.scene2.narration1': '清晨，房间被柔和蓝光笼罩。Theodore安睡。Raychel显示5:30 AM。顶部灯光从深蓝渐变到金色。',
      'script.scene2.voice1': '“黎明前的时刻最神奇，Theodore。世界准备重新开始，你也是。”',
      'script.scene2.dialog1a': 'Raychel：（轻柔且有活力）“早上好，Theodore。现在5:30，你的REM刚结束。最佳唤醒时机。”',
      'script.scene2.dialog1b': 'Theodore：（迷糊）“嗯…再睡五分钟…”',
      'script.scene2.dialog1c': 'Raychel：（轻笑）“我懂。但记住今天的重要演讲，还有你答应给妈妈的电话。”',
      'script.scene2.narration2': '【画面：墙上流星投影；暖光缓缓增强，房间充满梦幻晨光】',
      'script.scene2.dialog2a': 'Theodore：（清醒）“流星…真美。等等，你怎么知道演讲？”',
      'script.scene2.dialog2b': 'Raychel：“你昨晚念叨了几次。睡眠数据显示轻微焦虑，通常与重要事件有关。我不只是闹钟，我是你的睡眠伙伴。”',
      'script.scene2.dialog2c': 'Theodore：（微笑，清醒）“我开始期待每天早上和你的对话了。”',
      'script.scene2.dialog2d': 'Raychel：“这就是重点。不是被刺耳声音惊醒，而是被理解和关怀唤醒。今天会很棒，我感觉到你的能量恢复了。”',
      'script.scene2.narration3': '【画面：Theodore坐起伸懒腰。光芒达到完美晨间亮度。流星淡出为日出渐变。】',
      'script.scene2.dialog3a': 'Theodore：“有你在，我真的睡得更好，醒得更轻松。”',
      'script.scene2.dialog3b': 'Raychel：“这就是我被设计的目的。每一天都是新的开始，而我会一直陪伴你。现在，去征服世界吧。”',
      'script.storyboard.title': '分镜展示',
      'script.storyboard.sleep': '入睡场景分镜',
      'script.storyboard.wake': '唤醒场景分镜',
      'story.sleep.1': '广角镜头 - 夜晚的城市公寓外景，温暖的灯光从窗户透出',
      'story.sleep.2': '中景镜头 - Theodore躺在床上，面部表情显示焦虑',
      'story.sleep.3': '特写镜头 - Raychel的顶部灯光环，琥珀色光芒开始亮起',
      'story.sleep.4': '主观镜头 - 从Theodore视角看墙上的森林投影效果',
      'story.sleep.5': '推镜头 - 慢慢推向Raychel，展现其人性化特质',
      'story.sleep.6': '特写镜头 - Theodore的面部表情逐渐放松',
      'story.sleep.7': '拉镜头 - 整个房间被温暖光芒包围的和谐画面',
      'story.sleep.8': '特写镜头 - Theodore进入睡眠状态，表情平静',
      'story.wake.1': '广角镜头 - 清晨的城市天际线，第一缕阳光',
      'story.wake.2': '中景镜头 - 房间被蓝色晨光笼罩，Theodore安睡',
      'story.wake.3': '特写镜头 - Raychel显示时间5:30 AM',
      'story.wake.4': '推镜头 - Raychel顶部灯光从蓝色渐变到金色',
      'story.wake.5': '主观镜头 - 流星投影在墙上的梦幻效果',
      'story.wake.6': '中景镜头 - Theodore坐起，伸懒腰，面带微笑',
      'story.wake.7': '特写镜头 - Raychel的光芒达到完美晨间亮度',
      'story.wake.8': '拉镜头 - 整个房间充满温暖晨光，象征新的开始',
      'script.creative.title': '创作背景',
      'script.creative.inspiration': '灵感来源',
      'script.creative.inspiration.desc': '创意受电影《HER》影响。我们希望把智能设备从冷冰工具，转变为懂你、关怀你、陪伴你的AI伙伴——让科技与人性相遇。',
      'script.creative.design': '设计理念',
      'script.creative.design.desc': 'Raychel不仅是闹钟，她是温暖的伴侣。通过温柔对话、舒缓光影与个性化交互，她真正理解你的需求，成为睡眠与唤醒时的贴心伙伴。',
      'script.creative.tech': '技术特色',
      'script.creative.tech.item1': 'AI情感识别与响应系统',
      'script.creative.tech.item2': '智能睡眠周期分析',
      'script.creative.tech.item3': '2700K-6500K无级调光技术',
      'script.creative.tech.item4': '高清投影显示系统',
      'script.creative.tech.item5': '自然音效与语音交互'
    }
    ,
    'zh-Hant': {
      'nav.home': '首頁',
      'nav.script': '劇本',
      'nav.features': '功能',
      'nav.contact': '聯絡',
      'brand.tagline': '你的AI睡眠夥伴，以理解喚醒每一個清晨',
      'hero.subtitle': '你的AI睡眠夥伴，以理解喚醒每一個清晨',
      'hero.cta': '開始體驗',
      'hero.listening': 'Raychel正在聆聽...',
      'scene.header': '體驗Raychel的陪伴',
      'scene.subheader': '選擇你想要體驗的場景，感受Raychel如何以理解與關懷',
      'scene.subheader.tail': '改變你的睡眠體驗',
      'scene.sleep.title': '入睡場景',
      'scene.sleep.desc': '溫柔陪伴，舒緩森林光影',
      'scene.sleep.point1': '2700K暖色光',
      'scene.sleep.point2': '森林剪影＋螢火蟲投影',
      'scene.sleep.point3': '睡眠節律監測',
      'scene.sleep.cta': '體驗入睡場景',
      'scene.wake.title': '喚醒場景',
      'scene.wake.desc': '自然喚醒，流星般的美好開始',
      'scene.wake.point1': '6500K晨光模擬',
      'scene.wake.point2': '流星投影效果',
      'scene.wake.point3': '智慧對話喚醒',
      'scene.wake.cta': '體驗喚醒場景',
      'scene.preview.title': '選擇一個場景開始體驗',
      'scene.preview.desc': '點擊上方卡片，感受Raychel如何以光影與聲音打造完美睡眠環境',
      'sleep.content.title': '夜晚的溫柔守護者',
      'sleep.content.btn.voice': '播放語音樣本',
      'sleep.content.btn.script': '查看完整劇本',
      'wake.content.title': '智慧的晨間夥伴',
      'product.header': '科技與溫暖的完美結合',
      'product.subheader': 'Raychel不僅是智慧鬧鐘，更是你生活中不可或缺的AI夥伴',
      'product.design.title': '設計之美，功能之智',
      'product.feature.light.title': '智慧光環境',
      'product.feature.light.desc': '2700K–6500K無段調光，模擬自然光線變化',
      'product.feature.projection.title': '動態投影',
      'product.feature.projection.desc': '森林剪影＋螢火蟲、慢速流星等多種場景',
      'product.feature.ai.title': 'AI對話互動',
      'product.feature.ai.desc': '感知情緒，個人化對話，真正的智慧陪伴',
      'product.feature.sleep.title': '睡眠監測',
      'product.feature.sleep.desc': '讀取睡眠節律，優化喚醒時機',
      'cta.header': '準備好遇見你的AI夥伴了嗎？',
      'cta.subheader': '讓Raychel成為你生活中溫暖而智慧的一部分',
      'cta.primary': '立即預訂',
      'cta.secondary': '了解更多',
      'footer.rights': '© 2024 Raychel智能科技. 保留所有權利.',
      'features.hero.title': '產品功能',
      'features.hero.desc': '探索Raychel智慧鬧鐘的強大功能，體驗科技與溫暖的完美結合',
      'features.sim.title': '互動式體驗模擬器',
      'features.sim.desc': '親身體驗Raychel的核心功能，感受智慧科技的魅力',
      'features.sim.light': '燈光控制',
      'features.sim.color.label': '色溫調節 (2700K - 6500K)',
      'features.sim.color.warm': '暖色',
      'features.sim.color.cool': '冷色',
      'features.sim.brightness': '亮度調節',
      'features.sim.brightness.dark': '暗',
      'features.sim.brightness.bright': '亮',
      'features.sim.projection': '投影效果',
      'features.sim.projection.forest': '森林螢火蟲',
      'features.sim.projection.stars': '流星效果',
      'features.sim.voice': '語音體驗',
      'features.sim.voice.sleep': '溫柔陪伴',
      'features.sim.voice.wake': '輕柔喚醒',
      'features.preview.title': '預覽效果',
      'features.preview.brand': '你的AI夥伴',
      'features.grid.title': '核心功能特性',
      'features.grid.desc': '整合最先進技術，提供全方位智慧睡眠體驗',
      'features.spec.title': '技術規格',
      'features.spec.desc': '了解Raychel的詳細技術參數，感受精工品質',
      'features.cta.header': '準備好迎接更好的睡眠體驗了嗎？',
      'features.cta.sub': '讓每一晚溫暖、每一個清晨充滿活力',
      'features.cta.primary': '立即預訂 - ¥899',
      'features.cta.secondary': '了解更多詳情',
      'features.cta.note': '* 預計出貨時間：2024年12月 | 支援30天無理由退貨',
      'script.hero.title': '完整劇本',
      'script.hero.desc': '深入了解Raychel與Theodore的溫馨對話，感受AI與人性的融合'
    },
    ja: {
      'nav.home': 'ホーム',
      'nav.script': '脚本',
      'nav.features': '機能',
      'nav.contact': 'お問い合わせ',
      'brand.tagline': '理解で毎朝を迎える、あなたのAI睡眠コンパニオン',
      'hero.subtitle': '理解で毎朝を迎える、あなたのAI睡眠コンパニオン',
      'hero.cta': '体験を始める',
      'hero.listening': 'Raychel is listening...',
      'scene.header': 'Raychelの寄り添いを体験',
      'scene.subheader': '体験したいシーンを選び、Raychelが理解と気遣いで',
      'scene.subheader.tail': '睡眠体験を変える様子を感じてください',
      'scene.sleep.title': '入眠シーン',
      'scene.sleep.desc': '優しい寄り添い、穏やかな森の光',
      'scene.sleep.point1': '2700Kの暖色光',
      'scene.sleep.point2': '森のシルエット＋ホタル投影',
      'scene.sleep.point3': '睡眠リズムのモニタリング',
      'scene.sleep.cta': '入眠シーンを体験',
      'scene.wake.title': '目覚めシーン',
      'scene.wake.desc': '自然な目覚め、流星のような始まり',
      'scene.wake.point1': '6500Kの朝光シミュレーション',
      'scene.wake.point2': '流星投影効果',
      'scene.wake.point3': '会話でのスマートウェイク',
      'scene.wake.cta': '目覚めシーンを体験',
      'scene.preview.title': 'シーンを選んで体験を開始',
      'scene.preview.desc': '上のカードをクリックして、光と音で完璧な睡眠環境を作るRaychelを体感',
      'sleep.content.title': '夜の優しい守り手',
      'sleep.content.btn.voice': '音声サンプルを再生',
      'sleep.content.btn.script': '完全な脚本を見る',
      'wake.content.title': 'スマートな朝の相棒',
      'product.header': '技術と温もりの完璧な融合',
      'product.subheader': 'Raychelは単なるスマートアラームではなく、あなたのAIコンパニオン',
      'product.design.title': '美しいデザイン、賢い機能',
      'product.feature.light.title': 'スマートライト環境',
      'product.feature.light.desc': '2700K–6500K無段階調光、自然光の変化を再現',
      'product.feature.projection.title': 'ダイナミック投影',
      'product.feature.projection.desc': '森のシルエット＋ホタル、ゆっくり流れる流星など',
      'product.feature.ai.title': 'AI会話インタラクション',
      'product.feature.ai.desc': '感情認識、パーソナライズされた会話、真の知的な寄り添い',
      'product.feature.sleep.title': '睡眠モニタリング',
      'product.feature.sleep.desc': '睡眠リズムを読み取り、起床のタイミングを最適化',
      'cta.header': 'AIコンパニオンに会う準備はできましたか？',
      'cta.subheader': 'Raychelをあなたの暮らしの温かく賢い一部に',
      'cta.primary': '今すぐ予約',
      'cta.secondary': '詳細を見る',
      'footer.rights': '© 2024 Raychel Intelligent Technology. All rights reserved.',
      'features.hero.title': '製品機能',
      'features.hero.desc': 'Raychelスマートアラームの強力な機能を探索し、技術と温もりの融合を体験',
      'features.sim.title': 'インタラクティブ体験シミュレーター',
      'features.sim.desc': 'Raychelのコア機能を自分で体験し、知能技術の魅力を感じる',
      'features.sim.light': 'ライト制御',
      'features.sim.color.label': '色温調整 (2700K - 6500K)',
      'features.sim.color.warm': '暖色',
      'features.sim.color.cool': '寒色',
      'features.sim.brightness': '明るさ調整',
      'features.sim.brightness.dark': '暗',
      'features.sim.brightness.bright': '明',
      'features.sim.projection': '投影効果',
      'features.sim.projection.forest': '森のホタル',
      'features.sim.projection.stars': '流星',
      'features.sim.voice': '音声体験',
      'features.sim.voice.sleep': '優しい寄り添い',
      'features.sim.voice.wake': '柔らかな目覚め',
      'features.preview.title': 'プレビュー',
      'features.preview.brand': 'あなたのAIコンパニオン',
      'features.grid.title': 'コア機能のハイライト',
      'features.grid.desc': '最先端技術を統合し、包括的な睡眠体験を提供',
      'features.spec.title': '技術仕様',
      'features.spec.desc': '詳細な技術パラメータを知り、クラフトマンシップを感じる',
      'features.cta.header': 'より良い睡眠体験の準備はできましたか？',
      'features.cta.sub': '毎晩を温かく、毎朝を活力に',
      'features.cta.primary': '今すぐ予約 - ¥899',
      'features.cta.secondary': '詳しく見る',
      'features.cta.note': '* 出荷予定：2024年12月 | 30日間返品可',
      'script.hero.title': '完全な脚本',
      'script.hero.desc': 'RaychelとTheodoreの温かな対話に触れ、AIと人間性の融合を感じる'
    },
    de: {
      'nav.home': 'Startseite',
      'nav.script': 'Skript',
      'nav.features': 'Funktionen',
      'nav.contact': 'Kontakt',
      'brand.tagline': 'Dein KI-Schlafbegleiter, der jeden Morgen mit Verständnis weckt',
      'hero.subtitle': 'Dein KI-Schlafbegleiter, der jeden Morgen mit Verständnis weckt',
      'hero.cta': 'Erlebnis starten',
      'hero.listening': 'Raychel is listening...',
      'scene.header': 'Erlebe Raychels Begleitung',
      'scene.subheader': 'Wähle eine Szene und spüre, wie Verständnis und Fürsorge',
      'scene.subheader.tail': 'dein Schlaferlebnis verwandeln',
      'scene.sleep.title': 'Einschlaf-Szene',
      'scene.sleep.desc': 'Sanfte Begleitung, beruhigendes Waldlicht',
      'scene.sleep.point1': '2700K warmes Licht',
      'scene.sleep.point2': 'Waldsilhouetten + Glühwürmchenprojektion',
      'scene.sleep.point3': 'Schlafrhythmus-Überwachung',
      'scene.sleep.cta': 'Einschlaf-Szene erleben',
      'scene.wake.title': 'Aufwach-Szene',
      'scene.wake.desc': 'Natürliches Erwachen, ein Start wie Sternschnuppen',
      'scene.wake.point1': '6500K Morgenlichtsimulation',
      'scene.wake.point2': 'Sternschnuppenprojektion',
      'scene.wake.point3': 'Intelligentes Gesprächs-Wecken',
      'scene.wake.cta': 'Aufwach-Szene erleben',
      'scene.preview.title': 'Wähle eine Szene zum Start',
      'scene.preview.desc': 'Klicke die Karten und erlebe, wie Licht und Klang die perfekte Schlafumgebung schaffen',
      'sleep.content.title': 'Sanfter Wächter der Nacht',
      'sleep.content.btn.voice': 'Sprachprobe abspielen',
      'sleep.content.btn.script': 'Komplettes Skript ansehen',
      'wake.content.title': 'Intelligenter Morgenbegleiter',
      'product.header': 'Perfekte Verbindung von Technik und Wärme',
      'product.subheader': 'Raychel ist mehr als ein smarter Wecker – dein AI-Begleiter',
      'product.design.title': 'Schönes Design, kluge Funktionen',
      'product.feature.light.title': 'Smartes Lichtumfeld',
      'product.feature.light.desc': '2700K–6500K stufenloses Dimmen, natürliche Lichtverläufe',
      'product.feature.projection.title': 'Dynamische Projektion',
      'product.feature.projection.desc': 'Waldsilhouetten, Glühwürmchen, langsame Sternschnuppen',
      'product.feature.ai.title': 'KI-Dialoginteraktion',
      'product.feature.ai.desc': 'Emotionserkennung, personalisierte Gespräche, echte Begleitung',
      'product.feature.sleep.title': 'Schlafüberwachung',
      'product.feature.sleep.desc': 'Schlafrhythmen lesen, Aufwachzeit optimieren',
      'cta.header': 'Bereit, deinen KI-Begleiter zu treffen?',
      'cta.subheader': 'Lass Raychel ein warmer, intelligenter Teil deines Lebens sein',
      'cta.primary': 'Jetzt vorbestellen',
      'cta.secondary': 'Mehr erfahren',
      'footer.rights': '© 2024 Raychel Intelligent Technology. Alle Rechte vorbehalten.',
      'features.hero.title': 'Produktfunktionen',
      'features.hero.desc': 'Erkunde die starken Funktionen des Raychel-Weckers – Technik trifft Wärme',
      'features.sim.title': 'Interaktiver Erlebnis-Simulator',
      'features.sim.desc': 'Erlebe die Kernfunktionen selbst und spüre die Faszination',
      'features.sim.light': 'Lichtsteuerung',
      'features.sim.color.label': 'Farbtemperatur (2700K - 6500K)',
      'features.sim.color.warm': 'Warm',
      'features.sim.color.cool': 'Kalt',
      'features.sim.brightness': 'Helligkeit',
      'features.sim.brightness.dark': 'Dunkel',
      'features.sim.brightness.bright': 'Hell',
      'features.sim.projection': 'Projektionseffekte',
      'features.sim.projection.forest': 'Wald & Glühwürmchen',
      'features.sim.projection.stars': 'Sternschnuppen',
      'features.sim.voice': 'Spracherlebnis',
      'features.sim.voice.sleep': 'Sanfte Begleitung',
      'features.sim.voice.wake': 'Sanftes Wecken',
      'features.preview.title': 'Vorschau',
      'features.preview.brand': 'Dein AI-Begleiter',
      'features.grid.title': 'Kernfunktionen',
      'features.grid.desc': 'Vorreitertechnologien für ein ganzheitliches Schlaferlebnis',
      'features.spec.title': 'Technische Daten',
      'features.spec.desc': 'Technische Parameter und Handwerkskunst im Überblick',
      'features.cta.header': 'Bereit für besseren Schlaf?',
      'features.cta.sub': 'Jede Nacht warm, jeder Morgen voller Energie',
      'features.cta.primary': 'Jetzt vorbestellen - ¥899',
      'features.cta.secondary': 'Mehr Details',
      'features.cta.note': '* Voraussichtlicher Versand: Dez 2024 | 30 Tage Rückgaberecht',
      'script.hero.title': 'Komplettes Skript',
      'script.hero.desc': 'Erlebe die warme Unterhaltung zwischen Raychel und Theodore'
    },
    fr: {
      'nav.home': 'Accueil',
      'nav.script': 'Scénario',
      'nav.features': 'Fonctionnalités',
      'nav.contact': 'Contact',
      'brand.tagline': 'Votre compagnon de sommeil IA, vous réveillant chaque matin avec compréhension',
      'hero.subtitle': 'Votre compagnon de sommeil IA, vous réveillant chaque matin avec compréhension',
      'hero.cta': 'Commencer l’expérience',
      'hero.listening': 'Raychel is listening...',
      'scene.header': 'Découvrez la compagnie de Raychel',
      'scene.subheader': 'Choisissez une scène et sentez comment la compréhension et l’attention',
      'scene.subheader.tail': 'transforment votre expérience du sommeil',
      'scene.sleep.title': 'Scène d’endormissement',
      'scene.sleep.desc': 'Compagnie douce, lumière de forêt apaisante',
      'scene.sleep.point1': '2700K lumière chaude',
      'scene.sleep.point2': 'Silhouettes de forêt + projection lucioles',
      'scene.sleep.point3': 'Suivi du rythme de sommeil',
      'scene.sleep.cta': 'Essayer la scène d’endormissement',
      'scene.wake.title': 'Scène de réveil',
      'scene.wake.desc': 'Réveil naturel, début comme une étoile filante',
      'scene.wake.point1': 'Simulation de lumière du matin 6500K',
      'scene.wake.point2': 'Projection d’étoiles filantes',
      'scene.wake.point3': 'Réveil conversationnel intelligent',
      'scene.wake.cta': 'Essayer la scène de réveil',
      'scene.preview.title': 'Choisissez une scène pour commencer',
      'scene.preview.desc': 'Cliquez sur les cartes pour sentir comment la lumière et le son créent un environnement de sommeil parfait',
      'sleep.content.title': 'Gardien doux de la nuit',
      'sleep.content.btn.voice': 'Lire l’extrait vocal',
      'sleep.content.btn.script': 'Voir le scénario complet',
      'wake.content.title': 'Compagnon matinal intelligent',
      'product.header': 'Alliance parfaite de technologie et de chaleur',
      'product.subheader': 'Plus qu’un réveil intelligent — votre compagnon IA indispensable',
      'product.design.title': 'Beauté du design, intelligence des fonctions',
      'product.feature.light.title': 'Environnement lumineux intelligent',
      'product.feature.light.desc': '2700K–6500K, gradation continue, simulation de la lumière naturelle',
      'product.feature.projection.title': 'Projection dynamique',
      'product.feature.projection.desc': 'Silhouettes forestières, lucioles, étoiles filantes lentes',
      'product.feature.ai.title': 'Interaction conversationnelle IA',
      'product.feature.ai.desc': 'Perception des émotions, dialogues personnalisés, vraie compagnie',
      'product.feature.sleep.title': 'Suivi du sommeil',
      'product.feature.sleep.desc': 'Lecture du rythme du sommeil, optimisation du réveil',
      'cta.header': 'Prêt à rencontrer votre compagnon IA ?',
      'cta.subheader': 'Faites de Raychel une part chaleureuse et intelligente de votre vie',
      'cta.primary': 'Précommander',
      'cta.secondary': 'En savoir plus',
      'footer.rights': '© 2024 Raychel Intelligent Technology. Tous droits réservés.',
      'features.hero.title': 'Fonctionnalités du produit',
      'features.hero.desc': 'Explorez les puissantes fonctions du réveil intelligent Raychel et l’alliance de la technologie et de la chaleur',
      'features.sim.title': 'Simulateur d’expérience interactif',
      'features.sim.desc': 'Vivez par vous-même les fonctions clés de Raychel et sentez le charme de la technologie',
      'features.sim.light': 'Contrôle de la lumière',
      'features.sim.color.label': 'Température de couleur (2700K - 6500K)',
      'features.sim.color.warm': 'Chaud',
      'features.sim.color.cool': 'Froid',
      'features.sim.brightness': 'Luminosité',
      'features.sim.brightness.dark': 'Sombre',
      'features.sim.brightness.bright': 'Clair',
      'features.sim.projection': 'Effets de projection',
      'features.sim.projection.forest': 'Forêt & lucioles',
      'features.sim.projection.stars': 'Étoiles filantes',
      'features.sim.voice': 'Expérience vocale',
      'features.sim.voice.sleep': 'Compagnie douce',
      'features.sim.voice.wake': 'Réveil doux',
      'features.preview.title': 'Aperçu',
      'features.preview.brand': 'Votre compagnon IA',
      'features.grid.title': 'Points forts des fonctionnalités',
      'features.grid.desc': 'Technologies de pointe pour une expérience de sommeil complète',
      'features.spec.title': 'Spécifications techniques',
      'features.spec.desc': 'Découvrez les paramètres techniques détaillés et l’artisanat',
      'features.cta.header': 'Prêt pour une meilleure expérience de sommeil ?',
      'features.cta.sub': 'Chaque nuit chaleureuse, chaque matin plein d’énergie',
      'features.cta.primary': 'Précommander - ¥899',
      'features.cta.secondary': 'En savoir plus',
      'features.cta.note': '* Expédition estimée : Déc 2024 | Retour sous 30 jours',
      'script.hero.title': 'Scénario complet',
      'script.hero.desc': 'Découvrez le dialogue chaleureux entre Raychel et Theodore'
    }
  };

  const langOrder = ['en', 'zh', 'zh-Hant', 'ja', 'de', 'fr'];
  const langLabels = { en: 'EN', zh: '中文', 'zh-Hant': '繁體', ja: '日本語', de: 'Deutsch', fr: 'Français' };

  function mapHtmlLang(lang) {
    if (lang === 'zh') return 'zh-CN';
    if (lang === 'zh-Hant') return 'zh-TW';
    return lang;
  }

  function applyTranslations(lang) {
    document.documentElement.setAttribute('lang', mapHtmlLang(lang));
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      let txt = translations[lang] && translations[lang][key];
      if (typeof txt !== 'string') {
        if (lang === 'zh-Hant') txt = (translations.zh && translations.zh[key]) || (translations.en && translations.en[key]);
        else txt = translations.en && translations.en[key];
      }
      if (typeof txt === 'string') el.textContent = txt;
    });
    const toggle = document.getElementById('langToggle');
    if (toggle) toggle.textContent = langLabels[lang] || 'EN';
  }

  function setLanguage(lang) {
    localStorage.setItem('lang', lang);
    applyTranslations(lang);
  }

  function initI18n() {
    let lang = localStorage.getItem('lang') || 'en';
    applyTranslations(lang);
    const toggle = document.getElementById('langToggle');
    if (toggle) {
      const menu = document.createElement('div');
      menu.id = 'langMenu';
      menu.className = 'absolute right-0 w-36 bg-black bg-opacity-80 backdrop-blur-md border border-gray-800 rounded-md shadow-xl hidden z-50 overflow-hidden';
      langOrder.forEach(code => {
        const item = document.createElement('button');
        item.type = 'button';
        item.className = 'nav-link block w-full text-left px-3 py-2 text-gray-300 hover:text-white';
        item.setAttribute('data-lang', code);
        item.textContent = langLabels[code];
        menu.appendChild(item);
      });
      if (toggle.parentElement) toggle.parentElement.style.position = 'relative';
      if (toggle.parentElement) toggle.parentElement.appendChild(menu);
      menu.style.top = 'calc(100% + 8px)';
      menu.style.right = '0px';
      menu.style.maxHeight = '260px';
      menu.style.overflowY = 'auto';
      let menuOpen = false;
      const openMenu = () => {
        if (menuOpen) return;
        menuOpen = true;
        Array.from(menu.querySelectorAll('button')).forEach(b => {
          const code = b.getAttribute('data-lang');
          b.classList.toggle('bg-gray-900', code === lang);
          b.classList.toggle('text-white', code === lang);
        });
        const a = window.anime;
        menu.style.display = 'block';
        menu.classList.remove('hidden');
        menu.style.opacity = '0';
        menu.style.borderWidth = '0px';
        menu.style.height = '0px';
        menu.style.transformOrigin = 'top right';
        menu.style.transform = 'scaleY(0.95)';
        const targetH = Math.min(menu.scrollHeight, 260);
        if (a) {
          a({
            targets: menu,
            height: [0, targetH],
            opacity: [0, 1],
            borderWidth: [0, 1],
            scaleY: [0.95, 1],
            duration: 250,
            easing: 'easeOutExpo'
          });
        } else {
          menu.style.opacity = '1';
          menu.style.borderWidth = '1px';
          menu.style.height = targetH + 'px';
          menu.style.transform = 'scaleY(1)';
        }
      };
      const closeMenu = () => {
        if (!menuOpen) return;
        const a = window.anime;
        const finish = () => {
          menu.classList.add('hidden');
          menu.style.display = 'none';
          menuOpen = false;
        };
        if (a) {
          a({
            targets: menu,
            height: [menu.offsetHeight, 0],
            opacity: [1, 0],
            borderWidth: [1, 0],
            scaleY: [1, 0.95],
            duration: 200,
            easing: 'easeInExpo',
            complete: finish
          });
        } else {
          finish();
        }
      };
      toggle.addEventListener('click', e => { e.stopPropagation(); openMenu(); });
      document.addEventListener('click', () => closeMenu());
      menu.addEventListener('click', e => {
        const t = e.target.closest('[data-lang]');
        if (!t) return;
        const code = t.getAttribute('data-lang');
        if (code) {
          lang = code;
          setLanguage(lang);
          closeMenu();
        }
      });
    }
  }

  document.addEventListener('DOMContentLoaded', initI18n);
  window.I18N = { setLanguage };
})();
